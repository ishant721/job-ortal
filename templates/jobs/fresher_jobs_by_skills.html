
{% extends "base.html" %}
{% load page_tags %}
{% load cache %}
{% load searchtags %}
{% load thumbnail %}

{% block block_canonical %}
<link rel="canonical" href="https://morgan.com{{ request.path }}"/>
{% endblock %}

{% block block_title %}
  {% include 'meta_data/fresher_jobs_by_skills_data.html'%}
{% endblock %}

{% block page_search_block %}
{% show_search_filter %}
{% endblock %}

{% block base %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
  <div class="container mx-auto px-4 py-8">
    <!-- Breadcrumb Section -->
    <div class="mb-6">
      <nav class="bg-white rounded-lg shadow-sm p-4">
        <ol class="flex items-center space-x-2 text-sm">
          <li>
            <a href="{{ request.scheme }}://{{ request.META.HTTP_HOST }}" 
               class="text-primary hover:text-blue-700 font-medium">
              Home
            </a>
          </li>
          <li class="text-gray-400">/</li>
          <li>
            <a href="{{ request.scheme }}://{{ request.META.HTTP_HOST }}/jobs"
               class="text-primary hover:text-blue-700 font-medium">
              Latest Jobs
            </a>
          </li>
          <li class="text-gray-400">/</li>
          <li class="text-gray-600 font-medium">Jobs by Skill</li>
        </ol>
      </nav>
    </div>

    <!-- Page Header -->
    <div class="text-center mb-8">
      <div class="bg-gradient-to-r from-primary to-accent rounded-2xl p-8 text-white shadow-lg">
        <h1 class="text-3xl font-bold mb-2">{{ h1_tag }}</h1>
        <p class="text-blue-100 text-lg">Discover opportunities that match your skills</p>
      </div>
    </div>

    <div class="grid lg:grid-cols-4 gap-8">
      
      <!-- Sidebar Filters -->
      <div class="lg:col-span-1">
        {% cache 604800 browse_jobs_by_skills job_type %}
          {% get_skills as total_skills %}
          {% get_industries as total_industries %}
          {% get_locations as total_locations %}
          {% get_qualifications as total_degrees %}
          
          <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="bg-gradient-to-r from-primary to-accent p-4">
              <h3 class="text-white font-semibold text-lg">Browse Categories</h3>
            </div>
            
            <div class="divide-y divide-gray-100">
              <!-- Skills Filter -->
              <div class="p-4">
                <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                  <i class="fas fa-code text-primary mr-2"></i>
                  Browse by Skills
                </h4>
                <ul class="space-y-2">
                  {% if job_type == 'fresher' %}
                    {% for skill in total_skills|slice:'10' %}
                      <li>
                        <a href="{% url 'skill_fresher_jobs' skill.slug %}" 
                           class="block text-gray-600 hover:text-primary hover:bg-blue-50 p-2 rounded transition-colors">
                          {{ skill.name }}
                        </a>
                      </li>
                    {% endfor %}
                    <li class="pt-2">
                      <a href="{% url "fresher_jobs_by_skills" 'fresher' %}" 
                         class="inline-block bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors">
                        View More Skills
                      </a>
                    </li>
                  {% else %}
                    {% for skill in total_skills|slice:'10' %}
                      <li>
                        <a href="{% url 'skill_walkin_jobs' skill.slug %}" 
                           class="block text-gray-600 hover:text-primary hover:bg-blue-50 p-2 rounded transition-colors">
                          {{ skill.name }}
                        </a>
                      </li>
                    {% endfor %}
                    <li class="pt-2">
                      <a href="{% url "fresher_jobs_by_skills" 'walkin' %}" 
                         class="inline-block bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors">
                        View More Skills
                      </a>
                    </li>
                  {% endif %}
                </ul>
              </div>

              <!-- Locations Filter -->
              <div class="p-4">
                <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                  <i class="fas fa-map-marker-alt text-accent mr-2"></i>
                  Browse by Locations
                </h4>
                <ul class="space-y-2">
                  {% if job_type == 'fresher' %}
                    {% for location in total_locations|slice:'10' %}
                      <li>
                        <a href="{% url "location_fresher_jobs" location.slug %}" 
                           class="block text-gray-600 hover:text-primary hover:bg-blue-50 p-2 rounded transition-colors">
                          {{ location.name }}
                        </a>
                      </li>
                    {% endfor %}
                    <li class="pt-2">
                      <a href="{% url "jobs_by_location" 'fresher-jobs' %}" 
                         class="inline-block bg-accent text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors">
                        View More Locations
                      </a>
                    </li>
                  {% else %}
                    {% for location in total_locations|slice:'10' %}
                      <li>
                        <a href="{% url 'location_walkin_jobs' location.slug %}" 
                           class="block text-gray-600 hover:text-primary hover:bg-blue-50 p-2 rounded transition-colors">
                          {{ location.name }}
                        </a>
                      </li>
                    {% endfor %}
                    <li class="pt-2">
                      <a href="{% url 'jobs_by_location' 'walkins' %}" 
                         class="inline-block bg-accent text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors">
                        View More Locations
                      </a>
                    </li>
                  {% endif %}
                </ul>
              </div>

              <!-- Industries Filter -->
              <div class="p-4">
                <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                  <i class="fas fa-building text-secondary mr-2"></i>
                  Browse by Industries
                </h4>
                <ul class="space-y-2">
                  {% for industry in total_industries|slice:'10' %}
                    <li>
                      <a href="{{ industry.get_job_url }}" 
                         class="block text-gray-600 hover:text-primary hover:bg-blue-50 p-2 rounded transition-colors">
                        {{ industry.name|get_industry_name }}
                      </a>
                    </li>
                  {% endfor %}
                  <li class="pt-2">
                    <a href="{% url "jobs_by_industry" %}" 
                       class="inline-block bg-secondary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors">
                      View More Industries
                    </a>
                  </li>
                </ul>
              </div>

              <!-- Degrees Filter -->
              <div class="p-4">
                <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                  <i class="fas fa-graduation-cap text-primary mr-2"></i>
                  Browse by Degrees
                </h4>
                <ul class="space-y-2">
                  {% for degree in total_degrees|slice:'10' %}
                    <li>
                      <a href="{% url 'job_skills' degree.slug %}" 
                         class="block text-gray-600 hover:text-primary hover:bg-blue-50 p-2 rounded transition-colors">
                        {{ degree.name }}
                      </a>
                    </li>
                  {% endfor %}
                  <li class="pt-2">
                    <a href="{% url "jobs_by_degree" %}" 
                       class="inline-block bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors">
                      View More Degrees
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        {% endcache %}
      </div>

      <!-- Main Content -->
      <div class="lg:col-span-3">
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <!-- Header -->
          <div class="bg-gradient-to-r from-primary to-accent p-6">
            <h2 class="text-2xl font-bold text-white">Browse Jobs by Skills</h2>
            <p class="text-blue-100 mt-2">Find opportunities that match your expertise</p>
          </div>

          <!-- Alphabet Filter -->
          <div class="p-6 border-b border-gray-100">
            <form name="skillform" id="skillform" method="post" class="hidden">
              <input type="hidden" name="alphabet_value" id="alphabet_value" value="{{request.POST.alphabet_value}}">
              <button type="submit"></button>
            </form>
            
            <div class="flex flex-wrap gap-2">
              <button class="alphabet-btn px-3 py-2 text-sm font-medium bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">
                All
              </button>
              {% for letter in "ABCDEFGHIJKLMNOPQRSTUVWXYZ" %}
                <button class="alphabet-btn px-3 py-2 text-sm font-medium bg-gray-100 text-gray-700 rounded-lg hover:bg-primary hover:text-white transition-colors {{ letter|lower }}">
                  {{ letter }}
                </button>
              {% endfor %}
            </div>
          </div>

          <!-- Skills Grid -->
          <div class="p-6">
            {% if all_skills %}
              <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                {% if job_type == 'fresher' %}
                  {% for skill in all_skills|dictsort:"name" %}
                    <a href="{% url 'skill_fresher_jobs' skill.slug %}" 
                       class="block p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-primary hover:bg-blue-50 transition-all group">
                      <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-primary to-accent rounded-lg flex items-center justify-center mr-3">
                          <i class="fas fa-code text-white text-sm"></i>
                        </div>
                        <div>
                          <h3 class="font-medium text-gray-800 group-hover:text-primary transition-colors">
                            {{ skill.name }}
                          </h3>
                          <p class="text-sm text-gray-500">Fresher Jobs</p>
                        </div>
                      </div>
                    </a>
                  {% endfor %}
                {% else %}
                  {% for skill in all_skills|dictsort:"name" %}
                    <a href="{% url 'skill_walkin_jobs' skill.slug %}" 
                       class="block p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-primary hover:bg-blue-50 transition-all group">
                      <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-primary to-accent rounded-lg flex items-center justify-center mr-3">
                          <i class="fas fa-walking text-white text-sm"></i>
                        </div>
                        <div>
                          <h3 class="font-medium text-gray-800 group-hover:text-primary transition-colors">
                            {{ skill.name }}
                          </h3>
                          <p class="text-sm text-gray-500">Walk-in Jobs</p>
                        </div>
                      </div>
                    </a>
                  {% endfor %}
                {% endif %}
              </div>
            {% else %}
              <div class="text-center py-12">
                <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <i class="fas fa-search text-gray-400 text-2xl"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-800 mb-2">No Skills Available</h3>
                <p class="text-gray-500">Please check back later for more opportunities.</p>
              </div>
            {% endif %}
          </div>
        </div>

        <!-- Additional Info Card -->
        <div class="mt-8 bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6 border border-blue-100">
          <div class="flex items-start">
            <div class="w-12 h-12 bg-gradient-to-r from-primary to-accent rounded-xl flex items-center justify-center mr-4 flex-shrink-0">
              <i class="fas fa-lightbulb text-white text-lg"></i>
            </div>
            <div>
              <h3 class="font-semibold text-gray-800 mb-2">Looking for the Perfect Job?</h3>
              <p class="text-gray-600 text-sm leading-relaxed">
                Browse through thousands of job opportunities across different skills and industries. 
                Use our filters to find exactly what you're looking for.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% block pj_info %}
{% endblock %}
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Handle alphabet filter clicks
    $('.alphabet-btn').click(function(e) {
        e.preventDefault();
        
        // Remove active class from all buttons
        $('.alphabet-btn').removeClass('bg-primary text-white').addClass('bg-gray-100 text-gray-700');
        
        // Add active class to clicked button
        $(this).removeClass('bg-gray-100 text-gray-700').addClass('bg-primary text-white');
        
        // Set the alphabet value and submit form
        const filterValue = $(this).hasClass('alphabet-btn') ? $(this).attr('class').split(' ').find(cls => cls.length === 1) || '' : '';
        $('#alphabet_value').val(filterValue);
        $('#skillform').submit();
    });

    // Set active state based on current filter
    function setActiveAlphabet() {
        const currentFilter = $("#alphabet_value").val();
        if (currentFilter) {
            $('.alphabet-btn').removeClass('bg-primary text-white').addClass('bg-gray-100 text-gray-700');
            $(`.alphabet-btn.${currentFilter}`).removeClass('bg-gray-100 text-gray-700').addClass('bg-primary text-white');
        }
    }
    
    setActiveAlphabet();

    // Load skills for job search
    $('#job_skills').empty().append(new Option('Select a Skill', ''));
    $.getJSON("{% url 'jobs:get_skills' %}", function (data) {
        $.each(JSON.parse(data.response), function (key, field) {
            $('#job_skills').append(new Option(field.fields.name, field.pk));
        });
    });
});
</script>
{% endblock %}
