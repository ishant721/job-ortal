{% extends "base.html" %}
{% load static %}

{% block title %}Create Job Alert - Morgan{% endblock %}

{% block meta_tags %}
<meta name="description" content="Create personalized job alerts on Morgan - Get notified when new jobs matching your skills and preferences are posted." />
<meta name="keywords" content="job alerts, job notifications, career alerts, job updates, morgan job portal" />
{% endblock %}

{% block base %}
<!-- Main Content -->
<div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-12">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Breadcrumb -->
        <nav class="mb-8" aria-label="breadcrumb">
            <ol class="flex items-center space-x-2 text-sm text-gray-600">
                <li>
                    <a href="/" class="hover:text-primary transition-colors duration-200">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                </li>
                <li><i class="fas fa-chevron-right text-gray-400 mx-2"></i></li>
                <li><a href="{% url 'my:alerts_list' %}" class="hover:text-primary transition-colors duration-200">Job Alerts</a></li>
                <li><i class="fas fa-chevron-right text-gray-400 mx-2"></i></li>
                <li class="text-primary font-medium">Create Alert</li>
            </ol>
        </nav>

        <!-- Header Section -->
        <div class="bg-white rounded-3xl shadow-xl p-8 mb-8 border border-gray-100 hover-lift">
            <div class="text-center">
                <div class="w-20 h-20 bg-gradient-to-br from-primary to-accent rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-lg">
                    <i class="fas fa-bell text-white text-3xl"></i>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
                    Create Job <span class="gradient-text">Alert</span>
                </h1>
                <p class="text-gray-600 text-lg max-w-2xl mx-auto leading-relaxed">
                    Tell us what kind of jobs you want and we'll notify you when matching opportunities become available
                </p>
            </div>
        </div>

        <!-- Job Alert Form -->
        <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100 hover-lift">
            <div class="bg-gradient-to-r from-primary via-blue-500 to-accent px-8 py-6">
                <h2 class="text-2xl font-bold text-white flex items-center">
                    <i class="fas fa-cog mr-3"></i>
                    Job Alert Details
                </h2>
            </div>
            
            <form method="post" class="p-8">
                {% csrf_token %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <!-- Job Alert Name -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-3" for="name">
                            <i class="fas fa-tag text-primary mr-2"></i>
                            Name your Job Alert *
                        </label>
                        <input type="text" id="name" name="name" required
                               placeholder="e.g., Python Developer Jobs in Bangalore"
                               class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300 font-medium">
                    </div>

                    <!-- Email Address -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-3" for="email">
                            <i class="fas fa-envelope text-primary mr-2"></i>
                            Email Address *
                        </label>
                        <input type="email" id="email" name="email" required
                               placeholder="Enter your email address"
                               class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300 font-medium">
                    </div>

                    <!-- Skills -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-3" for="skills">
                            <i class="fas fa-code text-primary mr-2"></i>
                            Skills *
                        </label>
                        <select id="skills" name="skill" multiple required
                                class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300">
                            {% for skill in skills %}
                            <option value="{{ skill.id }}">{{ skill.name }}</option>
                            {% endfor %}
                        </select>
                        <p class="text-xs text-gray-500 mt-2">Select multiple skills that match your expertise</p>
                    </div>

                    <!-- Location -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3" for="location">
                            <i class="fas fa-map-marker-alt text-primary mr-2"></i>
                            Location
                        </label>
                        <select id="location" name="location" multiple
                                class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300">
                            {% for city in cities %}
                            <option value="{{ city.id }}">{{ city.name }}</option>
                            {% endfor %}
                        </select>
                        <p class="text-xs text-gray-500 mt-2">Choose preferred work locations</p>
                    </div>

                    <!-- Industry -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3" for="industry">
                            <i class="fas fa-industry text-primary mr-2"></i>
                            Industry
                        </label>
                        <select id="industry" name="industry" multiple
                                class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300">
                            {% for industry in industries %}
                            <option value="{{ industry.id }}">{{ industry.name }}</option>
                            {% endfor %}
                        </select>
                        <p class="text-xs text-gray-500 mt-2">Select industries of interest</p>
                    </div>

                    <!-- Job Role -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3" for="role">
                            <i class="fas fa-briefcase text-primary mr-2"></i>
                            Job Role
                        </label>
                        <input type="text" id="role" name="role"
                               placeholder="e.g., Senior Developer, Team Lead"
                               class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300 font-medium">
                        <p class="text-xs text-gray-500 mt-2">Specify the desired job title or role</p>
                    </div>

                    <!-- Experience -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            <i class="fas fa-chart-line text-primary mr-2"></i>
                            Experience Range
                        </label>
                        <div class="grid grid-cols-2 gap-3">
                            <select name="min_year" 
                                    class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300">
                                <option value="">Min Years</option>
                                {% for year in years %}
                                <option value="{{ year }}">{{ year }} Year{{ year|pluralize }}</option>
                                {% endfor %}
                            </select>
                            <select name="max_year" 
                                    class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300">
                                <option value="">Max Years</option>
                                {% for year in years %}
                                <option value="{{ year }}">{{ year }} Year{{ year|pluralize }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Select your experience range</p>
                    </div>

                    <!-- Salary -->
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            <i class="fas fa-rupee-sign text-primary mr-2"></i>
                            Salary Range (Optional)
                        </label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <input type="number" name="min_salary" placeholder="Minimum Salary (₹)"
                                   class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300 font-medium">
                            <input type="number" name="max_salary" placeholder="Maximum Salary (₹)"
                                   class="w-full px-4 py-4 border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 hover:border-gray-300 font-medium">
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Set your expected salary range</p>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="flex flex-col sm:flex-row gap-4 mt-8 pt-6 border-t border-gray-200">
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-primary to-accent text-white py-4 px-8 rounded-2xl font-bold hover:from-blue-600 hover:to-green-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl group">
                        <i class="fas fa-bell mr-2 group-hover:rotate-12 transition-transform"></i>
                        Create Job Alert
                    </button>
                    <a href="{% url 'my:alerts_list' %}" 
                       class="flex-1 bg-gray-100 text-gray-700 py-4 px-8 rounded-2xl font-bold hover:bg-gray-200 transition-all duration-300 text-center group">
                        <i class="fas fa-arrow-left mr-2 group-hover:-translate-x-1 transition-transform"></i>
                        Back to Alerts
                    </a>
                </div>
            </form>
        </div>

        <!-- Help Section -->
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl p-8 mt-8 border border-blue-100">
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <div class="w-12 h-12 bg-primary rounded-2xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-info-circle text-white text-xl"></i>
                    </div>
                </div>
                <div class="ml-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">How Job Alerts Work</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-6 h-6 bg-accent rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <p class="text-gray-700 text-sm">Get instant email notifications when jobs matching your criteria are posted</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-6 h-6 bg-accent rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <p class="text-gray-700 text-sm">Create multiple alerts for different skill sets or locations</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-6 h-6 bg-accent rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <p class="text-gray-700 text-sm">Manage all your alerts from your dashboard anytime</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-6 h-6 bg-accent rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <p class="text-gray-700 text-sm">Modify or delete alerts whenever you want</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
$(document).ready(function() {
    // Initialize Lucide icons
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }

    // Custom Select2 styling to match the theme
    $.fn.select2.defaults.set('theme', 'default');
    
    // Initialize Select2 for multi-select dropdowns with custom styling
    $('#skills').select2({
        placeholder: "Select skills that match your expertise",
        allowClear: true,
        width: '100%',
        dropdownCssClass: 'select2-dropdown-custom',
        selectionCssClass: 'select2-selection-custom'
    });
    
    $('#location').select2({
        placeholder: "Choose your preferred work locations",
        allowClear: true,
        width: '100%',
        dropdownCssClass: 'select2-dropdown-custom',
        selectionCssClass: 'select2-selection-custom'
    });
    
    $('#industry').select2({
        placeholder: "Select industries of interest",
        allowClear: true,
        width: '100%',
        dropdownCssClass: 'select2-dropdown-custom',
        selectionCssClass: 'select2-selection-custom'
    });

    // Add custom CSS for Select2 to match the theme
    $('<style>')
        .prop('type', 'text/css')
        .html(`
            .select2-container--default .select2-selection--multiple {
                border: 2px solid #e5e7eb !important;
                border-radius: 1rem !important;
                min-height: 3.5rem !important;
                padding: 0.5rem !important;
            }
            .select2-container--default.select2-container--focus .select2-selection--multiple {
                border-color: #4A90E2 !important;
                box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2) !important;
            }
            .select2-container--default .select2-selection--multiple .select2-selection__choice {
                background-color: #4A90E2 !important;
                border: none !important;
                color: white !important;
                border-radius: 0.75rem !important;
                padding: 0.25rem 0.75rem !important;
                margin: 0.25rem !important;
                font-weight: 500 !important;
            }
            .select2-container--default .select2-selection--multiple .select2-selection__choice__remove {
                color: white !important;
                margin-right: 0.5rem !important;
            }
            .select2-dropdown {
                border: 2px solid #e5e7eb !important;
                border-radius: 1rem !important;
                box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
            }
            .select2-container--default .select2-results__option--highlighted[aria-selected] {
                background-color: #4A90E2 !important;
            }
        `)
        .appendTo('head');

    // Form submission with loading state
    $('form').on('submit', function() {
        const submitBtn = $(this).find('button[type="submit"]');
        const originalText = submitBtn.html();
        
        submitBtn.html('<i class="fas fa-spinner animate-spin mr-2"></i>Creating Alert...')
               .prop('disabled', true);
        
        // Reset button after 5 seconds if form hasn't submitted
        setTimeout(() => {
            submitBtn.html(originalText).prop('disabled', false);
        }, 5000);
    });

    // Add hover effects to form elements
    $('input, select').on('focus', function() {
        $(this).closest('.grid > div, .md\\:col-span-2').addClass('transform scale-105 transition-transform duration-200');
    }).on('blur', function() {
        $(this).closest('.grid > div, .md\\:col-span-2').removeClass('transform scale-105 transition-transform duration-200');
    });
});
</script>
{% endblock %}